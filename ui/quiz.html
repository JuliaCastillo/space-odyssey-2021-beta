


<div class="quiz_backg">


    <div class="quiz_text">

        <h2><i><strong>Welcome to {{ @moduleData.module_name }}!</strong></i></h2>


        <button id="show_reading" class="quiz_button">Teach me something about {{ @moduleData.module_name }} first!</button>

        <div id="reading" style="display:none;">
            <br/>
            <p>{{ @moduleData.module_text | raw }}</p>
        </div>

        <br/>
        <br/>
        <h3><i>Quiz time!</i></h3>
        <br/>



        <repeat group="{{ @questions }}" value="{{ @question }}">
            <div>
            <p>{{ trim(@question.question) }}</p>
                <div class="row">
                    <div class="col-lg-4">
                        <label class="option"><input type="radio" name="{{ @question.question_number }}" value="1">  A. {{ @question.option_1 }}</label>
                    </div>
                    <div class="col-lg-8">
                        <label class="option"><input type="radio" name="{{ @question.question_number }}" value="2">  B. {{ @question.option_2 }}</label>
                    </div>
                </div>
                <div class="row">
                    <div class="col-lg-4">
                        <label class="option"><input type="radio" name="{{ @question.question_number }}" value="3">  C. {{ @question.option_3 }}</label>
                    </div>
                    <div class="col-lg-8">
                        <label class="option"><input type="radio" name="{{ @question.question_number }}" value="4">  D. {{ @question.option_4 }}</label>
                    </div>
                </div>


<!--            <label class="option"><input type="radio" name="{{ @question.question_number }}" value="3">  C. {{ @question.option_3 }}</label>-->
<!--            <label class="option"><input type="radio" name="{{ @question.question_number }}" value="4">  D. {{ @question.option_4 }}</label>-->
            <br>
            <div class="answers" id="{{ @question.question_number }}"></div>

            </div>
            <br>
        </repeat>
        <button class="quiz_button" onclick="checkAllAnswers()"> Check all answers </button>
    </div>

<!--    <div class="blob">-->
<!--        <img src="assets/img/blob.svg">-->
<!--    </div>-->

</div>



<script src="{{@BASE}}/ui/js/jquery.min.js"></script>
<script>

    $(document).ready(function(){
        $("#show_reading").click(function(){
            $("#reading").slideToggle();
        });
    });

    function checkAllAnswers() {
        for (var i = 1; i <= 5; i++) {
            checkAnswers(i);
        }
    }

    function checkAnswers(qid) {

        $.ajax({
            type: 'GET',
            url: "{{ @BASE }}/quiz/" + qid,
            success: function(response) {
                // https://stackoverflow.com/questions/596351/how-can-i-know-which-radio-button-is-selected-via-jquery
                let selected = $('input[name='+ qid +']:checked').val();
                console.log('Selected: '+ selected);
                console.log('Correct: ' + response);

                if (parseInt(selected) === parseInt(response)) {
                    $('#' + qid).html('Correct!');
                } else {
                    switch (parseInt(response)) {
                        case 1:
                            option = "A";
                            break;
                        case 2:
                            option = 'B';
                            break;
                        case 3:
                            option = 'C';
                            break;
                        case 4:
                            option = 'D';
                            break;
                    }
                    $('#' + qid).html('Incorrect! The correct answer is option '+ option);
                }

            },
            failure: function() {
                console.log("failure");
            },
        });
    }
</script>

