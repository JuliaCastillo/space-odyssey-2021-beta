

<!-- ======= Modules Section ======= -->
<section id="modules" class="modules section-bg">
    <div class="container">

        <div class="section-title" data-aos="fade-right">
            <h2>Quizzes</h2>
            <p>Each quiz helps you to learn about a different element in space. Try them out!</p>
        </div>

        <h4>The Solar System</h4>
        <br />
        <div class="row" data-aos="zoom-in">

            <repeat group="{{ @modules }}" value="{{ @module }}">
                <div class="col-lg-3 module_selector" id="l{{ @module.module_id }}" onclick="moduleClick(this.id)">
                    <img class="module_image" src="{{ @module.image }}">
                    <check if="{{ @SESSION.userName=='UNSET' }}">
                        <false>
                            <img class="module_stars" id="image{{ @module.module_id }}" style="display: none">
                        </false>
                    </check>

                </div>
            </repeat>
        </div>
        <br />
        <br />
        <br />
        <div class="section-title" data-aos="fade-right">
            <h4>Coming soon...</h4>
            <p>The Big Bang, the Solar System's formation, Galaxies, and other planets</p>
        </div>

    </div>
</section>



<script src="{{@BASE}}/ui/js/jquery.min.js"></script>
<script>

    function moduleClick(clicked_module) {
        // from https://www.w3schools.com/jquery/jquery_ajax_get_post.asp
        $.post("{{ @BASE }}/", {
                module: clicked_module.substring(1),
            },
            function(result){
                // from https://love2dev.com/blog/ways-to-use-javascript-redirect-to-another-page/
                window.location.replace("{{ @BASE }}" + result);
            }
        );
    }


    var stars = {
        0: "assets/img/module-stars/Stars0.svg",
        1: "assets/img/module-stars/Stars1.svg",
        2: "assets/img/module-stars/Stars2.svg",
        3: "assets/img/module-stars/Stars3.svg",
        4: "assets/img/module-stars/Stars4.svg",
        5: "assets/img/module-stars/Stars5.svg"
    };

    function loadUserProgress(module_id){
        const stars_image = document.getElementById('image' + module_id);
        $.ajax({
            type: 'GET',
            url: "{{ @BASE }}/progress/" + module_id,
            success: function(response) {
                if (parseInt(response) in stars) {
                    stars_image.style.display = "initial";
                    stars_image.src = stars[parseInt(response)];
                }
            },
            failure: function() {
                console.log("Failure loading user progress");
            },
        });
    }

    $(document).ready(function(){
        for (var i = 1; i <= 2; i++) {
           loadUserProgress(i);
        }
    });


</script>
